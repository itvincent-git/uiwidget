/**
* MessageboxÌáÊ¾´°¿Ú
*
* @author Shilei(shilei@ceopen.cn) Vincent(zhongyongsheng@ceopen.cn) 
* @data 11-03-24
* @version 1.0.1 
*/
(function(b){b.uiwidget=b.uiwidget||{};b.uiwidget.Messagebox=function(a,c){b.extend(this,c);this.messagebox=b(a);this.init();this.render()};b.uiwidget.Messagebox.prototype={OK_TEXT:"\u786e \u5b9a",CANCEL_TEXT:"\u53d6 \u6d88",CLOSE_TEXT:"\u5173 \u95ed",ASK_TITLE:"\u63d0\u793a",ALERT_TITLE:"\u8b66\u544a",SUCCESS_TITLE:"\u6210\u529f",ERROR_TITLE:"\u5931\u8d25",init:function(){},render:function(){},renderWindow:function(){var a=b('<div class="msg-window-wrap" onselectstart="return false;" style="-moz-user-select: none;"><div class="msg-window-header"><div class="msg-window-header-left"></div><div class="msg-window-header-content"><span></span></div><div class="msg-window-header-right"></div></div><div class="btn-msg-window-close-noraml"></div><div class="msg-window-container" ><div class="msg-window-body"><div class="msg-window-body-left"></div><div class="msg-window-body-center"><div class="msg-window-ico-prompt"></div><div class="msg-window-msg-content"><table cellpadding="0" cellspacing="0"><tr><td></td></tr></table></div></div><div class="msg-window-body-right"></div></div><a href="#" id="msg-focus"/><div class="msg-window-button" ></div> </div><div class="msg-window-bottom"><div class="msg-window-bottom-left"></div><div class="msg-window-bottom-middle"></div><div class="msg-window-bottom-right"></div></div></div>');
b(document.body).append(a);this.titleEl=a.find("div.msg-window-header-content>span");this.msgEl=a.find("div.msg-window-msg-content td");this.iconEl=a.find("div.msg-window-body-center>div")[0];this.buttonEl=a.find("div.msg-window-button");a.drag({handler:b(".msg-window-header")});return a},renderMask:function(){var a=b('<div class="mask"><iframe frameborder="0" style="width:100%;height:100%"></iframe></div>');b(document.body).append(a);return a},message:function(a){this.show();a.type?this[a.type](a):
this.customCommand(a);b(document.body).bind("keydown",{windowEl:this.windowEl},this.keydown)},keydown:function(a){if(a.which==13){a=a.data.windowEl.find("div.btn-order");a.length>0&&a.first().click()}},customCommand:function(a){a.title&&this.setTitle(a.title);this.setMsg(a.msg);a.iconCls&&this.setIconCls(a.iconCls);var c=b("div.msg-window-wrap");c.css("left",(document.body.clientWidth-c[0].clientWidth)/2+document.body.scrollLeft);c.css("top",(b(window).height()-c[0].clientHeight)/2+document.body.scrollTop);
a.buttons&&this.setButton(a.buttons);var d=this;this.windowEl.find("div.btn-order").each(function(e){b(this).bind("click",function(){a.fn&&a.fn({index:e},a.msg);d.hide()});b(this).find("li.middle-normal").hover(function(){b(this).prev().addClass("left-over");b(this).addClass("middle-over");b(this).next().addClass("right-over")},function(){b(this).prev().removeClass("left-over");b(this).removeClass("middle-over");b(this).next().removeClass("right-over")})});this.windowEl.find("div.btn-msg-window-close-noraml").unbind("click");
this.windowEl.find("div.btn-msg-window-close-noraml").hover(function(){b(this).removeClass("btn-msg-window-close-noraml");b(this).addClass("btn-msg-window-close-over")},function(){b(this).removeClass("btn-msg-window-close-over");b(this).addClass("btn-msg-window-close-noraml")});this.windowEl.find("div.btn-msg-window-close-noraml").bind("click",function(){a.fn&&a.fn({index:-1},a.msg);d.hide()})},ask:function(a){this.setTitle(this.ASK_TITLE);this.setIconCls("msg-window-ico-prompt");this.setButton([{text:this.OK_TEXT,
iconCls:"ico-btn-order-ok"},{text:this.CANCEL_TEXT,iconCls:"ico-btn-order-close"}]);this.customCommand(a)},alert:function(a){this.setTitle(this.ALERT_TITLE);this.setIconCls("msg-window-ico-warning");this.setButton([{text:this.OK_TEXT,iconCls:"ico-btn-order-ok"},{text:this.CANCEL_TEXT,iconCls:"ico-btn-order-close"}]);this.customCommand(a)},success:function(a){this.setTitle(this.SUCCESS_TITLE);this.setIconCls("msg-window-ico-success");this.setButton([{text:this.OK_TEXT,iconCls:"ico-btn-order-ok"}]);
this.customCommand(a)},error:function(a){this.setTitle(this.ERROR_TITLE);this.setIconCls("msg-window-ico-error");this.setButton([{text:this.OK_TEXT,iconCls:"ico-btn-order-ok"}]);this.customCommand(a)},getWindow:function(){return this.windowEl||(this.windowEl=this.renderWindow())},getMask:function(){return this.maskEl||(this.maskEl=this.renderMask())},setTitle:function(a){this.titleEl.html(a)},setMsg:function(a){this.msgEl.html(a)},setIconCls:function(a){this.iconEl.className=a},setButton:function(a){this.buttonEl.empty();
for(var c=0;c<a.length;c++)a[c].iconCls?this.buttonEl.append(['<div class="btn-order"><ul><li class="left-normal"></li><li class="middle-normal"><input type="button" class="',a[c].iconCls,'"/>',a[c].text,'</li><li class="right-normal"></li></ul></div>'].join("")):this.buttonEl.append(['<div class="btn-order"><ul><li class="left-normal"></li><li class="middle-normal">',a[c].text,'</li><li class="right-normal"></li></ul></div>'].join(""))},show:function(){this.getWindow().show();this.getMask();var a=
document.body.scrollHeight;if(document.body.scrollHeight<=document.body.clientHeight)a=document.body.clientHeight;if(b.browser.mozilla)a=b(document).height();b("div.mask").height(a).show();this.windowEl.find("#msg-focus").focus()},hide:function(){this.getWindow().hide();this.getMask().hide();b(document.body).unbind("keydown",this.keydown)}};b.messagebox=function(a){b.uiwidget.Messagebox.instance=b.uiwidget.Messagebox.instance||new b.uiwidget.Messagebox(document.body,{});return b.uiwidget.Messagebox.instance.message(a)}})(jQuery);
